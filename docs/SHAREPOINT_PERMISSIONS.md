# SharePoint List 權限控制說明

## 目前狀況

當您在 SharePoint 網站 `https://53514268.sharepoint.com/sites/msteams_ffd922` 建立清單時：

- ✅ **預設權限**：所有群組成員（`rhema_all@rhema.com.tw` 群組的所有成員）都可以看到清單
- ⚠️ **需要手動設定**：如果要限制只有特定人可以看到，需要在 SharePoint 中手動設定權限

## 請款單權限需求

根據您的需求：
- **申請人**：只能看到自己建立的請款單
- **會計**：可以看到所有人的請款單（用於審核和統整）

## 設定權限的方法

### 方法 1：在 SharePoint 網站中設定（推薦）

1. **前往 SharePoint 網站**
   - 開啟：`https://53514268.sharepoint.com/sites/msteams_ffd922`
   - 找到您建立的「請款單」清單

2. **設定清單權限**
   - 點選清單右上角的「設定」圖示（齒輪）
   - 選擇「清單設定」
   - 點選「此清單的權限」
   - 點選「停止繼承權限」（這樣可以自訂權限）
   - 移除「所有人」的權限（如果不需要）
   - 新增「會計群組」或「會計人員」的權限（給予「參與」或「編輯」權限）

3. **設定項目層級權限（重要！）**
   - 在清單設定中，找到「進階設定」
   - 在「項目層級權限」區塊中：
     - 選擇「僅限使用者可以讀取和編輯自己的項目」
     - 或者選擇「建立和編輯所有項目，但只能讀取自己的項目」
   - 這樣可以確保：
     - 申請人只能看到自己建立的請款單
     - 會計（因為有清單層級的權限）可以看到所有人的請款單

### 方法 2：透過 Microsoft Graph API 設定（進階）

如果您希望透過程式自動設定權限，可以使用 Microsoft Graph API，但這需要：
- 取得清單的權限資訊
- 設定項目層級權限
- 設定特定使用者或群組的權限

這需要額外的開發工作，建議先使用方法 1。

## 建議的權限設定

### 請款單清單

1. **清單層級權限**
   - 會計群組：**參與** 或 **編輯** 權限（可以看到所有項目）
   - 其他群組成員：**讀取** 權限（但因為項目層級限制，只能看到自己的）

2. **項目層級權限**
   - 啟用「使用者只能讀取和編輯自己的項目」
   - 這樣申請人只能看到自己建立的請款單

### 人事清單

如果人事清單需要更嚴格的權限：
- 只有 HR 和主管可以看到
- 設定方式類似，但只給予 HR 群組和主管群組權限

## 注意事項

1. **權限繼承**：預設情況下，清單會繼承網站的權限。如果要自訂，需要先「停止繼承權限」。

2. **會計權限**：會計需要「參與」或「編輯」權限才能看到所有人的請款單，即使項目層級設定了限制。

3. **測試權限**：設定完成後，建議用不同帳號測試，確認權限是否正確。

## 未來改進

如果未來需要透過程式自動設定權限，可以：
1. 建立一個權限設定頁面
2. 使用 Microsoft Graph API 自動設定清單和項目權限
3. 整合到請款單建立流程中

但目前建議先使用 SharePoint 網站的手動設定方式，這樣更直觀且容易管理。

